"use strict";(self.webpackChunkdocs_contracts=self.webpackChunkdocs_contracts||[]).push([[858],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>p});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=a.createContext({}),d=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(i.Provider,{value:t},e.children)},u="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,i=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=d(n),m=r,p=u["".concat(i,".").concat(m)]||u[m]||f[m]||o;return n?a.createElement(p,s(s({ref:t},c),{},{components:n})):a.createElement(p,s({ref:t},c))}));function p(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=m;var l={};for(var i in t)hasOwnProperty.call(t,i)&&(l[i]=t[i]);l.originalType=e,l[u]="string"==typeof e?e:r,s[1]=l;for(var d=2;d<o;d++)s[d]=n[d];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},334:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>s,default:()=>f,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var a=n(7462),r=(n(7294),n(3905));const o={sidebar_position:2},s="Jetton Wallet",l={unversionedId:"jetton/JettonWallet",id:"jetton/JettonWallet",title:"Jetton Wallet",description:"This Jetton Wallet smart contract provides a framework for Jetton MastWalleter that comply with the TEP-0074 standard.",source:"@site/docs/jetton/JettonWallet.md",sourceDirName:"jetton",slug:"/jetton/JettonWallet",permalink:"/docs.contracts/docs/jetton/JettonWallet",draft:!1,editUrl:"https://github.com/Ton-Dynasty/tondynasty-contracts/pulls/docs/jetton/JettonWallet.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Jetton Master",permalink:"/docs.contracts/docs/jetton/JettonMaster"},next:{title:"Tutorial - NFT",permalink:"/docs.contracts/docs/category/tutorial---nft"}},i={},d=[{value:"Overview",id:"overview",level:2},{value:"Our Trait",id:"our-trait",level:2},{value:"Message Types",id:"message-types",level:3},{value:"<code>JettonTransfer</code>:",id:"jettontransfer",level:4},{value:"<code>JettonTransferNotification</code>:",id:"jettontransfernotification",level:4},{value:"<code>JettonBurn</code>:",id:"jettonburn",level:4},{value:"<code>JettonExcesses</code>:",id:"jettonexcesses",level:4},{value:"<code>JettonInternalTransfer</code>:",id:"jettoninternaltransfer",level:4},{value:"<code>JettonBurnNotification</code>:",id:"jettonburnnotification",level:4},{value:"Must Override Functions",id:"must-override-functions",level:3},{value:"<code>calculate_jetton_wallet_init(owner_address: Address)</code>:",id:"calculate_jetton_wallet_initowner_address-address",level:4},{value:"Optional Override Functions",id:"optional-override-functions",level:3},{value:"<code>_internal_transfer_validate(ctx: Context, msg: JettonInternalTransfer)</code>:",id:"_internal_transfer_validatectx-context-msg-jettoninternaltransfer",level:4},{value:"<code>_internal_transfer_estimate_remain_value(ctx: Context, msg: JettonInternalTransfer)</code>:",id:"_internal_transfer_estimate_remain_valuectx-context-msg-jettoninternaltransfer",level:4},{value:"<code>_internal_transfer_notification(ctx: Context, msg: JettonInternalTransfer)</code>:",id:"_internal_transfer_notificationctx-context-msg-jettoninternaltransfer",level:4},{value:"<code>_internal_transfer_excesses(ctx: Context, msg: JettonInternalTransfer, remain: Int)</code>:",id:"_internal_transfer_excessesctx-context-msg-jettoninternaltransfer-remain-int",level:4},{value:"<code>_burn_validate(ctx: Context, msg: JettonBurn)</code>:",id:"_burn_validatectx-context-msg-jettonburn",level:4},{value:"<code>_burn_tokens(ctx: Context, msg: JettonBurn)</code>:",id:"_burn_tokensctx-context-msg-jettonburn",level:4},{value:"<code>_transfer_validate(ctx: Context, msg: JettonTransfer)</code>:",id:"_transfer_validatectx-context-msg-jettontransfer",level:4},{value:"<code>_transfer_estimate_remain_value(ctx: Context, msg: JettonTransfer)</code>:",id:"_transfer_estimate_remain_valuectx-context-msg-jettontransfer",level:4},{value:"<code>_transfer_jetton(ctx: Context, msg: JettonTransfer)</code>:",id:"_transfer_jettonctx-context-msg-jettontransfer",level:4},{value:"How to Use",id:"how-to-use",level:2},{value:"Basic Usage",id:"basic-usage",level:3},{value:"Advanced Usage",id:"advanced-usage",level:3}],c={toc:d},u="wrapper";function f(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"jetton-wallet"},"Jetton Wallet"),(0,r.kt)("p",null,"This Jetton Wallet smart contract provides a framework for Jetton MastWalleter that comply with the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ton-blockchain/TEPs/blob/master/text/0074-jettons-standard.md"},"TEP-0074")," standard."),(0,r.kt)("h2",{id:"overview"},"Overview"),(0,r.kt)("p",null,"In TEP-0074, the standard of Jetton is defined. Each Jetton has corresponding Jetton Wallet contract. Each user will have a corresponding Jetton Wallet for different Jettons. Jetton Wallet is responsible for storing the number of Jettons and providing some basic functions, such as transfer, mint, burn, etc."),(0,r.kt)("p",null,"If you need to get the information of the entire Jetton Wallet, you can get it through ",(0,r.kt)("inlineCode",{parentName:"p"},"get_wallet_data()"),".\n",(0,r.kt)("inlineCode",{parentName:"p"},"get_wallet_data()")," will return a ",(0,r.kt)("inlineCode",{parentName:"p"},"WalletData"),", which contains the basic information of the Jetton Wallet, roughly as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"struct WalletData {\n    balance: Int as coins;      // amount of jettons on wallet\n    owner: Address;             // address of wallet owner;\n    jetton: Address;            // address of Jetton master-address\n    jetton_wallet_code: Cell;   // with code of this wallet\n}\n\n// @dev  get_wallet_data will return wallet data, which follows TEP 0074 standard\nget fun get_wallet_data(): WalletData{\n    return WalletData {\n        balance: self.balance,\n        owner: self.owner,\n        jetton: self.jetton_master,\n        jetton_wallet_code: self.calculate_jetton_wallet_init(self.owner).code\n    };\n}\n")),(0,r.kt)("h2",{id:"our-trait"},"Our Trait"),(0,r.kt)("h3",{id:"message-types"},"Message Types"),(0,r.kt)("p",null,"For Jetton Wallet, we have implemented several Message Types according to TEP-0074, which are used for transfer, burn Jetton, send notification, etc."),(0,r.kt)("h4",{id:"jettontransfer"},(0,r.kt)("inlineCode",{parentName:"h4"},"JettonTransfer"),":"),(0,r.kt)("p",null,"If you want to transfer Jetton, you can use ",(0,r.kt)("inlineCode",{parentName:"p"},"JettonTransfer")," to send to Jetton Wallet. Jetton Wallet will transfer Jetton to the Jetton Wallet owned by ",(0,r.kt)("inlineCode",{parentName:"p"},"destination"),", and bring back the remaining TON to ",(0,r.kt)("inlineCode",{parentName:"p"},"response_destination"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"message(0x0f8a7ea5) JettonTransfer {\n    query_id: Int as uint64;                // arbitrary request number\n    amount: Int as coins;                   // amount of jettons to transfer\n    destination: Address;                   // address of the new owner of the jettons\n    response_destination: Address;          // address where to send a response with confirmation of a successful transfer and the rest of the incoming message Toncoins.\n    custom_payload: Cell?;                  // optional custom payload\n    forward_ton_amount: Int as coins;       // the amount of nanotons to be sent to the destination address.\n    forward_payload: Slice as remaining;    // optional custom data that should be sent to the destination address.\n}\n")),(0,r.kt)("h4",{id:"jettontransfernotification"},(0,r.kt)("inlineCode",{parentName:"h4"},"JettonTransferNotification"),":"),(0,r.kt)("p",null,"After Jetton Wallet transfer Jetton to others, it will send a ",(0,r.kt)("inlineCode",{parentName:"p"},"JettonTransferNotification")," to the new owner of the Jetton."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"message(0x7362d09c) JettonTransferNotification {\n    query_id: Int as uint64;                // arbitrary request number\n    amount: Int as coins;                   // amount of jettons to transfer\n    sender: Address;                        // address of the sender of the jettons\n    forward_payload: Slice as remaining;    // optional custom payload\n}\n")),(0,r.kt)("h4",{id:"jettonburn"},(0,r.kt)("inlineCode",{parentName:"h4"},"JettonBurn"),":"),(0,r.kt)("p",null,"Jetton Wallet will burn Jetton in its own contract."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"message(0x595f07bc) JettonBurn {\n    query_id: Int as uint64;        // arbitrary request number\n    amount: Int as coins;           // amount of jettons to burn\n    response_destination: Address;  // address where to send a response with confirmation of a successful burn and the rest of the incoming message coins.\n    custom_payload: Cell?;          // optional custom payload\n}\n")),(0,r.kt)("h4",{id:"jettonexcesses"},(0,r.kt)("inlineCode",{parentName:"h4"},"JettonExcesses"),":"),(0,r.kt)("p",null,"After Jetton Wallet transfer Jetton to others, if there is remaining TON, it will send a ",(0,r.kt)("inlineCode",{parentName:"p"},"JettonExcesses")," to the sender of the Jetton."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"message(0xd53276db) JettonExcesses {\n    query_id: Int as uint64;        // arbitrary request number\n}\n")),(0,r.kt)("h4",{id:"jettoninternaltransfer"},(0,r.kt)("inlineCode",{parentName:"h4"},"JettonInternalTransfer"),":"),(0,r.kt)("p",null,"The transfer of Jetton Wallet to other Jetton Wallet or Jetton Master."),(0,r.kt)("p",null,"For example:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Transfer between Jetton Wallet and other Jetton Wallet: Jetton Wallet sends a ",(0,r.kt)("inlineCode",{parentName:"p"},"JettonInternalTransfer")," to Jetton Wallet, and Jetton Wallet will transfer Jetton to the Jetton Wallet owned by ",(0,r.kt)("inlineCode",{parentName:"p"},"destination"),", and bring back the remaining TON to ",(0,r.kt)("inlineCode",{parentName:"p"},"response_destination"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Transfer between Jetton Master and Jetton Wallet: When Jetton Master Mint Jetton to Jetton Wallet, it will send a ",(0,r.kt)("inlineCode",{parentName:"p"},"JettonInternalTransfer")," to Jetton Wallet."))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"message(0x178d4519) JettonInternalTransfer {\n    query_id: Int as uint64;                // arbitrary request number\n    amount: Int as coins;                   // amount of jettons to transfer\n    response_address: Address;              // address where to send a response with confirmation of a successful transfer and the rest of the incoming message coins.\n    from: Address;                          // address of the sender of the jettons\n    forward_ton_amount: Int as coins;       // the amount of nanotons to be sent to the destination address.\n    forward_payload: Slice as remaining;    // optional custom data that should be sent to the destination address.\n}\n")),(0,r.kt)("h4",{id:"jettonburnnotification"},(0,r.kt)("inlineCode",{parentName:"h4"},"JettonBurnNotification"),":"),(0,r.kt)("p",null,"After Jetton Wallet burn Jetton, it will send a ",(0,r.kt)("inlineCode",{parentName:"p"},"JettonBurnNotification")," to the Jetton Master."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"message(0x7bdd97de) JettonBurnNotification {\n    query_id: Int as uint64;          // arbitrary request number\n    amount: Int as coins;             // amount of jettons to burn\n    sender: Address;                  // address of the sender of the jettons\n    response_destination: Address;    // address where to send a response with confirmation of a successful burn and the rest of the incoming message coins.\n}\n")),(0,r.kt)("h3",{id:"must-override-functions"},"Must Override Functions"),(0,r.kt)("p",null,"Jetton Wallet defines a function that must be implemented in the child contract:"),(0,r.kt)("h4",{id:"calculate_jetton_wallet_initowner_address-address"},(0,r.kt)("inlineCode",{parentName:"h4"},"calculate_jetton_wallet_init(owner_address: Address)"),":"),(0,r.kt)("p",null,"Calculate Jetton Wallet's StateInit by owner address."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"// @dev  calculate_jetton_wallet_init will get init code of a jetton wallet by provided it's owner address\n// @note one MUST override this function and return state init of the inherited jetton wallet implementation\nabstract inline fun calculate_jetton_wallet_init(owner_address: Address): StateInit;\n")),(0,r.kt)("h3",{id:"optional-override-functions"},"Optional Override Functions"),(0,r.kt)("p",null,"Jetton Wallet defines several Optional Override Functions:"),(0,r.kt)("h4",{id:"_internal_transfer_validatectx-context-msg-jettoninternaltransfer"},(0,r.kt)("inlineCode",{parentName:"h4"},"_internal_transfer_validate(ctx: Context, msg: JettonInternalTransfer)"),":"),(0,r.kt)("p",null,"Check whether the internal transfer message is legal, for example, check whether the sender is Jetton Master or Jetton Wallet."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},'// @dev  _internal_tranfer_validate will validate internal transfer message, usually it will check that sender is a jetton master or jetton wallet\n// @note this function will triggered on receiving JettonTransfer message\nvirtual inline fun _internal_transfer_validate(ctx: Context, msg: JettonInternalTransfer) {\n    if(ctx.sender != self.jetton_master){\n        let init: StateInit = self.calculate_jetton_wallet_init(msg.from);\n        require(ctx.sender == contractAddress(init), "JettonWallet: Only Jetton master or Jetton wallet can call this function");\n    }\n}\n')),(0,r.kt)("h4",{id:"_internal_transfer_estimate_remain_valuectx-context-msg-jettoninternaltransfer"},(0,r.kt)("inlineCode",{parentName:"h4"},"_internal_transfer_estimate_remain_value(ctx: Context, msg: JettonInternalTransfer)"),":"),(0,r.kt)("p",null,"Estimate the remaining TON after the transfer, which will deduct the storage fee, forward fee and gas consumption."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"// @dev  _internal_transfer_estimate_remain_value will estimate remain value after deducting storage fee, forward fee and gas consumption\nvirtual inline fun _internal_transfer_estimate_remain_value(ctx: Context, msg: JettonInternalTransfer): Int {\n    let tonBalanceBeforeMsg: Int = myBalance() - ctx.value;\n    let storage_fee: Int =  self.minTonsForStorage - min(tonBalanceBeforeMsg, self.minTonsForStorage);\n    let remain: Int = ctx.value - (storage_fee + self.gasConsumption);\n    if (msg.forward_ton_amount > 0) {\n        remain = remain - (ctx.readForwardFee() + msg.forward_ton_amount);\n    }\n    return remain;\n}\n")),(0,r.kt)("h4",{id:"_internal_transfer_notificationctx-context-msg-jettoninternaltransfer"},(0,r.kt)("inlineCode",{parentName:"h4"},"_internal_transfer_notification(ctx: Context, msg: JettonInternalTransfer)"),":"),(0,r.kt)("p",null,"After transfer, notify the owner of the Jetton Wallet."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"// @dev  _internal_transfer_notification will send notification to the owner of the jetton wallet\nvirtual inline fun _internal_transfer_notification(ctx: Context, msg: JettonInternalTransfer) {\n    if (msg.forward_ton_amount > 0) {\n        send(SendParameters{\n            to: self.owner,\n            value: msg.forward_ton_amount,\n            mode: SendPayGasSeparately,\n            bounce: false,\n            body: JettonTransferNotification{\n                query_id: msg.query_id,\n                amount: msg.amount,\n                sender: msg.from,\n                forward_payload: msg.forward_payload\n            }.toCell()\n        });\n    }\n}\n")),(0,r.kt)("h4",{id:"_internal_transfer_excessesctx-context-msg-jettoninternaltransfer-remain-int"},(0,r.kt)("inlineCode",{parentName:"h4"},"_internal_transfer_excesses(ctx: Context, msg: JettonInternalTransfer, remain: Int)"),":"),(0,r.kt)("p",null,"After transfer, send the remaining TON back."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"// @dev  _internal_transfer_excesses will send excesses message back after transfer action completed\nvirtual inline fun _internal_transfer_excesses(ctx: Context, msg: JettonInternalTransfer, remain: Int){\n    if((msg.response_address != newAddress(0, 0)) && remain > 0){\n        send(SendParameters{\n            to: msg.response_address,\n            value: remain,\n            bounce: false,\n            mode: SendIgnoreErrors,\n            body: JettonExcesses{\n                query_id: msg.query_id\n            }.toCell()\n        });\n    }\n}\n")),(0,r.kt)("h4",{id:"_burn_validatectx-context-msg-jettonburn"},(0,r.kt)("inlineCode",{parentName:"h4"},"_burn_validate(ctx: Context, msg: JettonBurn)"),":"),(0,r.kt)("p",null,"Check whether the burn request is legal, for example, check whether the sender is Jetton Wallet's Owner."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},'// @dev  _burn_validate will conduct custom checking when receiving JettonBurn message\nvirtual inline fun _burn_validate(ctx: Context, msg: JettonBurn) {\n    require(ctx.sender == self.owner, "JettonWallet: Only owner can burn tokens");\n}\n')),(0,r.kt)("h4",{id:"_burn_tokensctx-context-msg-jettonburn"},(0,r.kt)("inlineCode",{parentName:"h4"},"_burn_tokens(ctx: Context, msg: JettonBurn)"),":"),(0,r.kt)("p",null,"Burn Jetton and notify Jetton Master."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"// @dev  _burn_tokens will burn tokens and send JettonBurnNotification back to the jetton master\n// @note this message is bounceable, if burn action failed, the message will be bounced back, you should increase the balance of the wallet\nvirtual inline fun _burn_tokens(ctx: Context, msg: JettonBurn) {\n    send(SendParameters{\n        to: self.jetton_master,\n        value: 0,\n        mode: SendRemainingValue,\n        bounce: true,\n        body: JettonBurnNotification{\n            query_id: msg.query_id,\n            amount: msg.amount,\n            sender: self.owner,\n            response_destination: msg.response_destination\n        }.toCell()\n    });\n}\n")),(0,r.kt)("h4",{id:"_transfer_validatectx-context-msg-jettontransfer"},(0,r.kt)("inlineCode",{parentName:"h4"},"_transfer_validate(ctx: Context, msg: JettonTransfer)"),":"),(0,r.kt)("p",null,"Check whether the transfer request is legal, for example, check whether the sender is Jetton Wallet's Owner."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},'// @dev  _transfer_validate will conduct custom checking when receiving JettonTransfer message\nvirtual inline fun _transfer_validate(ctx: Context, msg: JettonTransfer) {\n    require(ctx.sender == self.owner, "Only owner can call this function");\n\n}\n')),(0,r.kt)("h4",{id:"_transfer_estimate_remain_valuectx-context-msg-jettontransfer"},(0,r.kt)("inlineCode",{parentName:"h4"},"_transfer_estimate_remain_value(ctx: Context, msg: JettonTransfer)"),":"),(0,r.kt)("p",null,"Estimate the remaining TON after the transfer, which will deduct the storage fee, forward fee and gas consumption."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},'// @dev  _transfer_estimate_remain_value will estimate remain value after deducting storage fee, forward fee and gas consumption\nvirtual inline fun _transfer_estimate_remain_value(ctx: Context, msg: JettonTransfer) {\n    let fwd_count: Int = 1;\n    if (msg.forward_ton_amount > 0) {\n        fwd_count = 2;\n    }\n    require(ctx.value > fwd_count * ctx.readForwardFee() + 2 * self.gasConsumption + self.minTonsForStorage, "Not enough funds to transfer");\n}\n')),(0,r.kt)("h4",{id:"_transfer_jettonctx-context-msg-jettontransfer"},(0,r.kt)("inlineCode",{parentName:"h4"},"_transfer_jetton(ctx: Context, msg: JettonTransfer)"),":"),(0,r.kt)("p",null,"Transfer Jetton, if the destination doesn't have Jetton Wallet, it will create a Jetton Wallet for the destination."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},"// @dev  _transfer_jetton will transfer jettons to the jetton wallet of the destination address (owner of jetton wallet)\n// @note  this message is bounceable, if transfer action failed, the message will be bounced back, you should increase the balance of the wallet\nvirtual inline fun _transfer_jetton(ctx: Context, msg: JettonTransfer) {\n    let init: StateInit = self.calculate_jetton_wallet_init(msg.destination);\n    let receiver: Address = contractAddress(init);\n    send(SendParameters{\n        to: receiver,\n        value: 0,\n        bounce: true,\n        mode: SendRemainingValue,\n        body: JettonInternalTransfer{\n            query_id: msg.query_id,\n            amount: msg.amount,\n            response_address: msg.response_destination,\n            from: self.owner,\n            forward_ton_amount: msg.forward_ton_amount,\n            forward_payload: msg.forward_payload\n        }.toCell(),\n        code: init.code,\n        data: init.data\n    });\n}\n")),(0,r.kt)("h2",{id:"how-to-use"},"How to Use"),(0,r.kt)("h3",{id:"basic-usage"},"Basic Usage"),(0,r.kt)("p",null,"To use our Jetton Wallet Trait, you need to implement a Jetton Wallet and a ",(0,r.kt)("a",{parentName:"p",href:"JettonMaster"},"Jetton Master")," contract, and implement ",(0,r.kt)("inlineCode",{parentName:"p"},"calculate_jetton_wallet_init(owner_address: Address)")," and other must override functions and init function, for example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},'import "@stdlib/deploy";\nimport "./packages/token/jetton/JettonMaster";\nimport "./packages/token/jetton/JettonWallet";\n\ncontract ExampleJettonWallet with JettonWallet {\n    balance: Int as coins = 0;\n    owner: Address;\n    jetton_master: Address;\n\n    init(owner: Address, jetton_master: Address) {\n        self.owner = owner;\n        self.jetton_master = jetton_master;\n    }\n\n    override inline fun calculate_jetton_wallet_init(owner_address: Address): StateInit {\n        return initOf ExampleJettonWallet(owner_address, self.jetton_master);\n    }\n}\n\ncontract ExampleJettonMaster with JettonMaster, Deployable {\n    total_supply: Int as coins = 0;\n    mintable: Bool = true;\n    owner: Address;\n    jetton_content: Cell;\n\n    init(owner: Address, jetton_content: Cell){\n        self.owner = owner;\n        self.jetton_content = jetton_content;\n    }\n    override inline fun calculate_jetton_wallet_init(owner_address: Address): StateInit {\n        return initOf ExampleJettonWallet(owner_address, myAddress());\n    }\n}\n')),(0,r.kt)("h3",{id:"advanced-usage"},"Advanced Usage"),(0,r.kt)("p",null,"If you want to implement your own Jetton Wallet, you can Override Jetton Wallet's Optional Override Functions. For example, if you want anyone to be able to burn Jetton in your Jetton Wallet, you can implement ",(0,r.kt)("inlineCode",{parentName:"p"},"_burn_validate"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-typescript"},'override inline fun _burn_validate(ctx: Context, msg: JettonBurn) {\n    require(ctx.sender != newAddress(0, 0), "Null address can not burn tokens");\n}\n')))}f.isMDXComponent=!0}}]);